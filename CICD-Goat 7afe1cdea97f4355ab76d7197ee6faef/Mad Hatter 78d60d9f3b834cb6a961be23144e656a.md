# Mad Hatter

![Untitled](Mad%20Hatter%2078d60d9f3b834cb6a961be23144e656a/b798d608-5651-4894-babf-c45f4fd9034a.png)

Kiá»ƒm tra, ta tháº¥y alice khÃ´ng cÃ³ quyá»n truy cáº­p vÃ o cáº¥u hÃ¬nh project trÃªn Jenkins

![Untitled](Mad%20Hatter%2078d60d9f3b834cb6a961be23144e656a/Untitled.png)

Kiá»ƒm tra source code, ta khÃ´ng tháº¥y file cáº¥u hÃ¬nh pipeline (Jenkinsfile), nhÆ° váº­y cÃ³ thá»ƒ pipeline Ä‘Ã£ Ä‘Æ°á»£c cáº¥u hÃ¬nh trá»±c tiáº¿p trÃªn project cá»§a Jenkins.

![Untitled](Mad%20Hatter%2078d60d9f3b834cb6a961be23144e656a/Untitled%201.png)

Ta thá»­ push code lÃªn branch main xem cÃ³ trigger sang Jenkins Ä‘á»ƒ build khÃ´ng

![Untitled](Mad%20Hatter%2078d60d9f3b834cb6a961be23144e656a/Untitled%202.png)

Ta tháº¥y code Ä‘Æ°á»£c push trá»±c tiáº¿p lÃªn branch main mÃ  khÃ´ng bá»‹ cháº·n láº¡i, tuy nhiÃªn khÃ´ng Ä‘Æ°á»£c trigger sang Jenkins Ä‘á»ƒ build

![Untitled](Mad%20Hatter%2078d60d9f3b834cb6a961be23144e656a/Untitled%203.png)

Thá»­ Ä‘á»•i qua branch khÃ¡c vÃ  táº¡o PR vÃ  main, ta tháº¥y sá»± kiá»‡n Ä‘Ã£ Ä‘Æ°á»£c trigger

![Untitled](Mad%20Hatter%2078d60d9f3b834cb6a961be23144e656a/Untitled%204.png)

LÃ m cÃ¡ch nÃ o Ä‘á»ƒ ta cÃ³ thá»ƒ in secret ra mÃ  khÃ´ng dÃ¹ng file Jenkinsfile, thá»­ xem ká»¹ log khi build

![Untitled](Mad%20Hatter%2078d60d9f3b834cb6a961be23144e656a/Untitled%205.png)

Ta tháº¥y pipeline cÃ³ config Ä‘á»ƒ cháº¡y lá»‡nh make, Ä‘á»c log ta ta tháº¥y nÃ³ Ä‘ang cháº¡y Makefile vÃ  Ä‘ang lá»—i táº¡i dÃ²ng sá»‘ 2 trong whoami target. Thá»­ kiá»ƒm tra trong source code cÃ³ chá»©a file Makefile nhÆ° log bÃ¡o khÃ´ng, ta tháº¥y file Makefile, vá»›i cÃ¢u lá»‡nh Ä‘Ãºng nhÆ° trÃªn log â‡’ file nÃ y Ä‘Æ°á»£c thá»±c thi trong pipeline

![Untitled](Mad%20Hatter%2078d60d9f3b834cb6a961be23144e656a/Untitled%206.png)

Biáº¿n FLAG khi hiá»ƒn thá»‹ trÃªn console dÆ°á»›i dáº¡ng *** â‡’ Ä‘Ã¢y cÃ³ thá»ƒ lÃ  tÃªn secret flag cáº§n tÃ¬m, vÃ¬ biáº¿n secret sáº½ tá»± Ä‘á»™ng á»Ÿ dáº¡ng *** khi Ä‘Æ°á»£c in ra trá»±c tiáº¿p

TÃ¬m hiá»ƒu má»™t chÃºt vá» Makefile:

<aside>
ğŸ’¡ Makefile lÃ  má»™t tá»‡p Ä‘Æ°á»£c sá»­ dá»¥ng trong quÃ¡ trÃ¬nh phÃ¡t triá»ƒn pháº§n má»m Ä‘á»ƒ tá»± Ä‘á»™ng hÃ³a cÃ¡c tÃ¡c vá»¥ nhÆ° biÃªn dá»‹ch mÃ£ nguá»“n vÃ  liÃªn káº¿t cÃ¡c tá»‡p Ä‘á»ƒ táº¡o ra chÆ°Æ¡ng trÃ¬nh hoáº·c pháº§n má»m hoÃ n chá»‰nh. NÃ³ chá»©a má»™t táº­p há»£p cÃ¡c quy táº¯c mÃ  make, má»™t cÃ´ng cá»¥ xÃ¢y dá»±ng, sá»­ dá»¥ng Ä‘á»ƒ xÃ¡c Ä‘á»‹nh cÃ¡c tÃ¡c vá»¥ cáº§n thá»±c hiá»‡n Ä‘á»ƒ Ä‘áº¡t Ä‘Æ°á»£c má»™t má»¥c tiÃªu cá»¥ thá»ƒ. Má»—i quy táº¯c trong Makefile bao gá»“m cÃ¡c má»¥c tiÃªu, cÃ¡c phá»¥ thuá»™c vÃ  cÃ¡c lá»‡nh cáº§n thiáº¿t Ä‘á»ƒ táº¡o ra má»¥c tiÃªu Ä‘Ã³.

</aside>

Táº¡o má»¥c tiÃªu má»›i Ä‘á»ƒ láº¥y flag, thá»±c hiá»‡n encode base64 tÆ°Æ¡ng tá»± lab 1:

![Untitled](Mad%20Hatter%2078d60d9f3b834cb6a961be23144e656a/Untitled%207.png)

Push code lÃªn vÃ  táº¡o MR vÃ o main, truy cáº­p vÃ o mÃ n console xem lá»‡nh Ä‘Æ°á»£c thá»±c thi khÃ´ng

Ta láº¥y thÃ nh cÃ´ng base64 cá»§a secret FLAG

![Untitled](Mad%20Hatter%2078d60d9f3b834cb6a961be23144e656a/Untitled%208.png)

Decode base64:

![Untitled](Mad%20Hatter%2078d60d9f3b834cb6a961be23144e656a/Untitled%209.png)

Submit flag thÃ nh cÃ´ng

![Untitled](Mad%20Hatter%2078d60d9f3b834cb6a961be23144e656a/Untitled%2010.png)

## **Äiá»ƒm yáº¿u báº£o máº­t:**

- Cáº¥u hÃ¬nh sai event trigger dáº«n Ä‘áº¿n háº­u quáº£ build cÃ¡c branch khÃ´ng mong muá»‘n.
- KhÃ´ng cáº¥u hÃ¬nh báº£o vá»‡ branch chÃ­nh dáº«n tá»›i má»i thay Ä‘á»•i code Ä‘á»u cÃ³ thá»ƒ Ä‘Æ°á»£c MR vÃ o main mÃ  khÃ´ng qua kiá»ƒm tra.
- KhÃ´ng cÃ³ sá»± kiá»ƒm soÃ¡t cÃ¡c file tham gia trá»±c tiáº¿p trong pipeline.

## Biá»‡n phÃ¡p kháº¯c phá»¥c:

- Branch chÃ­nh cáº§n Ä‘Æ°á»£c báº£o vá»‡, khÃ´ng ai cÃ³ quyá»n push trá»±c tiáº¿p code vÃ o branch chÃ­nh ngoáº¡i trá»« project owner hoáº·c user cÃ³ tháº©m quyá»n.
- Cáº¥u hÃ¬nh chÃ­nh xÃ¡c event cáº§n trigger.
- GiÃ¡m sÃ¡t vÃ  kiá»ƒm tra mÃ£ nguá»“n thÆ°á»ng xuyÃªn, Ä‘áº£m báº£o ráº±ng cÃ¡c thay Ä‘á»•i trong mÃ£ nguá»“n Ä‘Æ°á»£c xem xÃ©t vÃ  phÃª duyá»‡t bá»Ÿi cÃ¡c thÃ nh viÃªn cÃ³ kinh nghiá»‡m trong nhÃ³m.